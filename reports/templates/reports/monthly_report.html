<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>تقرير شهري - {{ clinic_name }}</title>
</head>
<body style="font-family: Arial, sans-serif; direction: rtl; text-align: right; margin: 20px;">
    <h2 style="color: #2c3e50;">تقرير شهري لعيادة {{ clinic_name }} - {{ date }}</h2>
    <p><strong>الفترة:</strong> من {{ date }} إلى {{ date|date:"Y-m-t" }}</p>
    
    <h3 style="color: #34495e;">إجمالي الشهر</h3>
    <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">
        <thead>
            <tr style="background-color: #f8f9fa;">
                <th style="border: 1px solid #ddd; padding: 10px;">البند</th>
                <th style="border: 1px solid #ddd; padding: 10px;">المبلغ (جنيه)</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td style="border: 1px solid #ddd; padding: 10px;">إجمالي المصروفات</td>
                <td style="border: 1px solid #ddd; padding: 10px;">{{ total_expenses }}</td>
            </tr>
            <tr>
                <td style="border: 1px solid #ddd; padding: 10px;">إجمالي الإيرادات</td>
                <td style="border: 1px solid #ddd; padding: 10px;">{{ total_incomes }}</td>
            </tr>
            <tr>
                <td style="border: 1px solid #ddd; padding: 10px;">صافي الربح</td>
                <td style="border: 1px solid #ddd; padding: 10px;">{{ net_profit }}</td>
            </tr>
        </tbody>
    </table>

    <h3 style="color: #34495e;">إحصائيات طرق الدفع</h3>
    <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">
        <thead>
            <tr style="background-color: #f8f9fa;">
                <th style="border: 1px solid #ddd; padding: 10px;">طريقة الدفع</th>
                <th style="border: 1px solid #ddd; padding: 10px;">المبلغ (جنيه)</th>
                <th style="border: 1px solid #ddd; padding: 10px;">عدد المعاملات</th>
            </tr>
        </thead>
        <tbody>
            {% for pm in payment_methods %}
                <tr>
                    <td style="border: 1px solid #ddd; padding: 10px;">{{ pm.name }}</td>
                    <td style="border: 1px solid #ddd; padding: 10px;">{{ pm.total_amount }}</td>
                    <td style="border: 1px solid #ddd; padding: 10px;">{{ pm.count }}</td>
                </tr>
            {% empty %}
                <tr>
                    <td colspan="3" style="border: 1px solid #ddd; padding: 10px; text-align: center;">لا توجد معاملات إيرادات هذا الشهر</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <h3 style="color: #34495e;">إحصائيات الأطباء</h3>
    <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">
        <thead>
            <tr style="background-color: #f8f9fa;">
                <th style="border: 1px solid #ddd; padding: 10px;">اسم الطبيب</th>
                <th style="border: 1px solid #ddd; padding: 10px;">الإيرادات (جنيه)</th>
                <th style="border: 1px solid #ddd; padding: 10px;">عدد المواعيد</th>
            </tr>
        </thead>
        <tbody>
            {% for doctor in doctor_details %}
                <tr>
                    <td style="border: 1px solid #ddd; padding: 10px;">{{ doctor.name }}</td>
                    <td style="border: 1px solid #ddd; padding: 10px;">{{ doctor.total_revenue }}</td>
                    <td style="border: 1px solid #ddd; padding: 10px;">{{ doctor.count }}</td>
                </tr>
            {% empty %}
                <tr>
                    <td colspan="3" style="border: 1px solid #ddd; padding: 10px; text-align: center;">لا توجد إيرادات مرتبطة بأطباء هذا الشهر</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <h3 style="color: #34495e;">إيرادات بدون طبيب</h3>
    <table style="width: 100%; border-collapse: collapse; margin-bottom: 20px;">
        <thead>
            <tr style="background-color: #f8f9fa;">
                <th style="border: 1px solid #ddd; padding: 10px;">البند</th>
                <th style="border: 1px solid #ddd; padding: 10px;">المبلغ (جنيه)</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td style="border: 1px solid #ddd; padding: 10px;">إيرادات بدون طبيب</td>
                <td style="border: 1px solid #ddd; padding: 10px;">{{ no_doctor_revenue }}</td>
            </tr>
        </tbody>
    </table>

    <h3 style="color: #34495e;">إحصائيات الخدمات</h3>
    <table style="width: 100%; border-collapse: collapse;">
        <thead>
            <tr style="background-color: #f8f9fa;">
                <th style="border: 1px solid #ddd; padding: 10px;">الخدمة</th>
                <th style="border: 1px solid #ddd; padding: 10px;">الإيرادات (جنيه)</th>
                <th style="border: 1px solid #ddd; padding: 10px;">عدد المواعيد</th>
            </tr>
        </thead>
        <tbody>
            {% for service in service_details %}
                <tr>
                    <td style="border: 1px solid #ddd; padding: 10px;">{{ service.name }}</td>
                    <td style="border: 1px solid #ddd; padding: 10px;">{{ service.total_revenue }}</td>
                    <td style="border: 1px solid #ddd; padding: 10px;">{{ service.count }}</td>
                </tr>
            {% empty %}
                <tr>
                    <td colspan="3" style="border: 1px solid #ddd; padding: 10px; text-align: center;">لا توجد إيرادات مرتبطة بخدمات هذا الشهر</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</body>
</html>